{% extends 'base.html' %}
{% block content %}
<main class="edit-trip-page" style="padding: 2rem 1rem; max-width: 900px; margin: 0 auto;">

  <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ -->
  <header style="text-align: center; margin-bottom: 2.5rem;">
    <h1 style="font-size: 2rem; font-weight: 700; color: var(--color-primary); margin-bottom: 0.5rem;">
      –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏–µ
    </h1>
    <p style="color: var(--color-text-secondary); font-size: 1.1rem;">
      –í–Ω–µ—Å–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è ‚Äî –∏ —Ç–≤–æ–π –ø–ª–∞–Ω —Å–Ω–æ–≤–∞ –∏–¥–µ–∞–ª–µ–Ω ‚ú®
    </p>
  </header>

  <!-- –§–æ—Ä–º–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è -->
  <section class="edit-form-section" style="background: var(--color-secondary); padding: 2.5rem; border-radius: 16px; box-shadow: 0 4px 20px rgba(0,0,0,0.05);">
    <form method="post" style="display: grid; gap: 1.5rem;">
      {% csrf_token %}
      <input type="hidden" name="trip_id" value="{{ trip.id }}">
      <div>
        <label for="edit-title" style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--color-text);">–ù–∞–∑–≤–∞–Ω–∏–µ –ø–æ–µ–∑–¥–∫–∏</label>
        <input 
          type="text" 
          id="edit-title" 
          name="title" 
          value="{{ trip.title }}" 
          style="width: 100%; padding: 12px; border: 1px solid var(--color-text-secondary); border-radius: 8px; background: var(--color-bg); color: var(--color-text); font-size: 1rem;">
      </div>

      <div>
        <label for="edit-description" style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--color-text);">–û–ø–∏—Å–∞–Ω–∏–µ</label>
        <textarea 
          id="edit-description" 
          name="discription" 
          rows="4" 
          style="width: 100%; padding: 12px; border: 1px solid var(--color-text-secondary); border-radius: 8px; background: var(--color-bg); color: var(--color-text); font-size: 1rem; resize: vertical;"
        >{{ trip.discription }}</textarea>
      </div>

      <div>
        <label for="edit-country" style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--color-text);">–°—Ç—Ä–∞–Ω–∞</label>
        <select 
          id="edit-country" 
          name="country" 
          style="width: 100%; padding: 12px; border: 1px solid var(--color-text-secondary); border-radius: 8px; background: var(--color-bg); color: var(--color-text); font-size: 1rem;"
        >
          <option value="japan">–Ø–ø–æ–Ω–∏—è</option>
          <option value="italy">–ò—Ç–∞–ª–∏—è</option>
          <option value="thailand">–¢–∞–∏–ª–∞–Ω–¥</option>
          <option value="iceland">–ò—Å–ª–∞–Ω–¥–∏—è</option>
          <option value="mexico">–ú–µ–∫—Å–∏–∫–∞</option>
          <option value="new-zealand">–ù–æ–≤–∞—è –ó–µ–ª–∞–Ω–¥–∏—è</option>
          <option value="egypt">–ï–≥–∏–ø–µ—Ç</option>
          <option value="brazil">–ë—Ä–∞–∑–∏–ª–∏—è</option>
          <option value="greece">–ì—Ä–µ—Ü–∏—è</option>
          <option value="switzerland">–®–≤–µ–π—Ü–∞—Ä–∏—è</option>
        </select>
      </div>

      <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
        <div>
          <label for="edit-departure" style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--color-text);">–î–∞—Ç–∞ –≤—ã–ª–µ—Ç–∞</label>
          <input 
            type="date" 
            id="edit-departure" 
            name="date_in" 
            value="{{ trip.date_in }}" 
            style="width: 100%; padding: 12px; border: 1px solid var(--color-text-secondary); border-radius: 8px; background: var(--color-bg); color: var(--color-text);">
        </div>
        <div>
          <label for="edit-return" style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--color-text);">–î–∞—Ç–∞ –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏—è</label>
          <input 
            type="date" 
            id="edit-return" 
            name="date_out"
            value="" 
            style="width: 100%; padding: 12px; border: 1px solid var(--color-text-secondary); border-radius: 8px; background: var(--color-bg); color: var(--color-text);">
        </div>
      </div>

      <div>
        <label for="edit-budget" style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--color-text);">–ë—é–¥–∂–µ—Ç (–≤ USD)</label>
        <input 
          type="number" 
          id="edit-budget" 
          name="price" 
          value="{{ trip.price }}" 
          style="width: 100%; padding: 12px; border: 1px solid var(--color-text-secondary); border-radius: 8px; background: var(--color-bg); color: var(--color-text); font-size: 1rem;">
      </div>

      <div style="display: flex; gap: 1rem; flex-wrap: wrap; justify-content: center;">
        <button type="submit" style="background: var(--color-accent); color: white; border: none; padding: 14px 32px; font-size: 1.1rem; border-radius: 50px; cursor: pointer; font-weight: 600; box-shadow: 0 4px 15px rgba(78, 205, 196, 0.3); display: flex; align-items: center; gap: 8px;">
          üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è
        </button>
        <a href="{% url 'planner' %}" style="background: var(--color-text-secondary); color: var(--color-text); text-decoration: none; padding: 14px 32px; font-size: 1.1rem; border-radius: 50px; display: flex; align-items: center; gap: 8px; justify-content: center; box-shadow: 0 4px 15px rgba(0,0,0,0.05);">
          üö´ –û—Ç–º–µ–Ω–∞
        </a>
      </div>
    </form>
  </section>

  <!-- –ü–æ–¥—Å–∫–∞–∑–∫–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) -->
  <section class="tip-section" style="margin-top: 2rem; padding: 1.25rem; background: var(--color-bg); border-radius: 12px; border-left: 4px solid var(--color-accent); color: var(--color-text);">
    <p style="margin: 0; font-size: 0.95rem;">
      üí° –°–æ–≤–µ—Ç: –Ω–µ –∑–∞–±—É–¥—å –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–∞—Ç—ã –∏ –±—é–¥–∂–µ—Ç ‚Äî –æ—Å–æ–±–µ–Ω–Ω–æ –µ—Å–ª–∏ –∫—É—Ä—Å –≤–∞–ª—é—Ç –∏–∑–º–µ–Ω–∏–ª—Å—è!
    </p>
  </section>

</main>
<script>
  let country_edit = document.querySelector('#edit-country')
  let options = country_edit.querySelectorAll('option')
  options.forEach(element => {
    if (element.value == '{{ trip.country }}') {
      element.setAttribute('selected', null)
    }
  });
  console.log('{{trip.date_in}}')
  if ('{{ trip.date_in }}'.includes('.')) {
    let date_in = '{{ trip.date_in }}'.split(".")
    date_in = `${date_in[2]}-${date_in[1]}-${date_in[0]}`
    console.log(date_in)
    let date_in_input = document.querySelector("#edit-departure")
    date_in_input.value = date_in
  }
  else {
    let date_in_input = document.querySelector("#edit-departure")
    date_in_input.value = '{{ trip.date_in }}'
  }
  if ('{{ trip.date_out }}'.includes('.')) {
    let date_out = '{{ trip.date_out }}'.split(".")
    date_out = `${date_out[2]}-${date_out[1]}-${date_out[0]}`
    let date_out_input = document.querySelector("#edit-return")
    date_out_input.value = date_out
  }
  else {
    let date_out_input = document.querySelector("#edit-return")
    date_out_input.value = '{{ trip.date_out }}'
  }
</script>
{% endblock %}